<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" as="style" data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&amp;display=swap" data-optimized-fonts="true"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta property="og:title" content="Jina AI is a Neural Search Company"/><meta name="author" content="Jina AI"/><meta property="og:locale" content="en_US"/><meta property="og:site_name" content="Jina AI"/><meta property="og:image" content="https://jina.ai/assets/images/jina_banner_new.png"/><meta property="og:type" content="website"/><meta property="og:description" content="We provide business and developers an opensource neural search ecosystem for understanding unstructured data faster and easier."/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://jina.ai/assets/images/jina_banner_new.png"/><meta property="twitter:title" content="Jina AI is a Neural Search Company"/><meta property="twitter:description" content="We provide business and developers an opensource neural search ecosystem for understanding unstructured data faster and easier."/><meta name="twitter:site" content="@JinaAI_"/><meta name="twitter:creator" content="@JinaAI_"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-96x96.png"/><link rel="icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&amp;display=swap" data-optimized-fonts="true"/><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Open source neural search ecosystem for businesses and developers, allowing anyone to search any kind of data with high availability and scalability."/><meta property="og:url" content="https://jina.ai/"/><meta property="og:title" content="Jina AI | Jina AI is a Neural Search Company"/><meta property="og:description" content="Open source neural search ecosystem for businesses and developers, allowing anyone to search any kind of data with high availability and scalability."/><meta property="og:locale" content="en"/><meta property="og:site_name" content="Jina AI, Ltd"/><link rel="canonical" href="https://jina.ai/"/><title>Advancing Open Domain Question Answering with RocketQA | Jina AI</title><meta name="next-head-count" content="33"/><link rel="preload" href="/_next/static/css/ec346583fec4e0e0c23d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ec346583fec4e0e0c23d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-f47d69457824065d04c3.js" defer=""></script><script src="/_next/static/chunks/framework-2191d16384373197bc0a.js" defer=""></script><script src="/_next/static/chunks/main-18f21ab86863c15f7e5d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-25c384a6dfe2e0ee232e.js" defer=""></script><script src="/_next/static/chunks/419-571d18b1d9b4fc2cda27.js" defer=""></script><script src="/_next/static/chunks/522-f41528aa8639e5478b36.js" defer=""></script><script src="/_next/static/chunks/100-3a8cb6004ce37f1c54f0.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-b044910cba761441deff.js" defer=""></script><script src="/_next/static/QU34lMMGJ1oQ3CbyH400h/_buildManifest.js" defer=""></script><script src="/_next/static/QU34lMMGJ1oQ3CbyH400h/_ssgManifest.js" defer=""></script><style id="__jsx-3128403005">.dropdown.jsx-3128403005{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(74,85,104,var(--tw-text-opacity));top:5rem;width:100%;border-radius:0.75rem;}.dropdown.jsx-3128403005>.jsx-3128403005:not([hidden])~.jsx-3128403005:not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse));border-style:solid;--tw-divide-opacity:1;border-color:rgba(235,235,235,var(--tw-divide-opacity));}</style><style id="__jsx-1573896879">.navbar.jsx-1573896879 a{display:inline-block;width:100%;}.navbar.jsx-1573896879 li:not(:first-child){margin-top:0.75rem;}.navbar.jsx-1573896879 a .btn{width:100%;}.navbar.jsx-1573896879 a:hover{--tw-text-opacity:1;color:rgba(0,129,129,var(--tw-text-opacity));}@media (min-width:640px){.navbar.jsx-1573896879 a,.navbar.jsx-1573896879 a .btn{width:auto;}.navbar.jsx-1573896879 li:not(:first-child){margin-top:0px;}.navbar.jsx-1573896879>li.jsx-1573896879:not(:last-child){margin-right:1.25rem;}}</style><style id="__jsx-649517993">.top-nav-bar.jsx-649517993{box-shadow:3px 6px 33px 0px #cdcdcd40;z-index:200;position:fixed;width:100vw;background:white;top:0;}</style><style id="__jsx-1324436386">.footer-links.jsx-1324436386 li{margin-top:0.25rem;}.footer-items-title.jsx-1324436386{font-size:1.375rem;line-height:1.5rem;-webkit-letter-spacing:0.22px;-moz-letter-spacing:0.22px;-ms-letter-spacing:0.22px;letter-spacing:0.22px;}</style><style id="__jsx-1956813867">.footer-left-margin.jsx-1956813867{width:20rem;height:inherit;background:no-repeat 40% 20%/30% url("/assets/images/planet-beige.svg");}.footer-right-margin.jsx-1956813867{width:16rem;height:inherit;background:no-repeat 10% 10%/50% url("/assets/images/planet-green.svg");}</style><style data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap">@font-face{font-family:'Poppins';font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLFj_V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLDz8V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrFJM.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLGT9V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLFj_Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLFj_Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLFj_Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLDz8Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLDz8Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLDz8Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrJJbecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrJJnecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLGT9Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLGT9Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLGT9Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><script async="" src="https://www.googletagmanager.com/gtag/js?id=undefined"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'undefined', {
              page_path: window.location.pathname,
            });
          </script><body><div id="__next"><div class="jsx-649517993 top-nav-bar"><div class="md:max-w-screen-lg lg:max-w-screen-xl mx-auto px-8 py-6 undefined"><div class="jsx-1573896879 flex flex-wrap justify-between items-center"><div class="jsx-1573896879"><a class="jsx-1573896879" href="/"><div class="text-gray-900 flex items-center font-semibold text-3xl"><img src="/assets/images/logo.svg" alt="Jina.ai logo" class="w-24"/></div></a></div><div class="jsx-1573896879 md:hidden"><button type="button" aria-label="show menu" class="jsx-1573896879 p-3 text-gray-900 rounded-md hover:bg-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round" class="jsx-1573896879 stroke-current h-6 w-6"><path d="M0 0h24v24H0z" stroke="none" class="jsx-1573896879"></path><path d="M4 6h16M4 12h16M4 18h16" class="jsx-1573896879"></path></svg></button></div><nav class="jsx-1573896879 w-full md:w-auto md:block mt-6 md:mt-0 hidden"><ul class="jsx-1573896879 navbar flex flex-col md:flex-row md:items-center font-medium text-xl text-gray-800 sm:p-0 bg-white sm:bg-transparent rounded"><a href="/careers" class="jsx-649517993"><span class="jsx-649517993 text-gray-700 text-lg mr-4 font-medium hidden md:inline-block">Careers</span></a><a href="/blog" class="jsx-649517993"><span class="jsx-649517993 text-gray-700 text-lg mr-4 font-medium hidden md:inline-block">Blog</span></a><a href="https://learn.jina.ai" class="jsx-649517993"><span class="jsx-649517993 text-gray-700 text-lg mr-4 font-medium hidden md:inline-block">Learn</span></a><div class="jsx-3128403005 md:hidden overflow-y-scroll"><ul class="jsx-3128403005 dropdown"><li class="jsx-3128403005 hover:bg-gray-200"><a href="/careers" rel="noopener noreferrer" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/careers-icon.svg" alt="careers icon" class="w-full h-full"/></div><a href="/careers" class="jsx-3128403005"><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Careers</span></a></div><span class="jsx-3128403005 text-xs text-gray-500">Interested in joining us? Find out what it&#x27;s like to work at Jina AI.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/blog" rel="noopener noreferrer" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/news-icon.svg" alt="news icon" class="w-full h-full"/></div><a href="/blog" class="jsx-3128403005"><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Blog</span></a></div><span class="jsx-3128403005 text-xs text-gray-500">Check out the latest news about our company and products.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="https://learn.jina.ai" rel="noopener noreferrer" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/docs-icon.svg" alt="docs icon" class="w-full h-full"/></div><a href="https://learn.jina.ai" class="jsx-3128403005"><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Learn</span></a></div><span class="jsx-3128403005 text-xs text-gray-500">Jina Learning Bootcamp</span></div></a></li></ul></div></ul></nav></div></div></div><div style="margin-top:5.5rem"><div class="min-h-screen"><main><div class="container mx-auto px-5 flex flex-col items-center"><img src="/assets/images/blog/2022-01-03_RocketQA/cover.png" alt="Advancing Open Domain Question Answering with RocketQA-image" class="rounded-lg md:rounded-none shadow-md md:shadow-lg mb-4 mt-8 md:my-0 w-full xl:rounded-b-3xl"/><article class="mb-16 md:mb-32 pt-5 pb-10 md:py-20 md:max-w-6xl rounded-b-lg xl:rounded-3xl md:px-32 w-full xl:-mt-20 bg-white md:shadow-lg"><div class="mb-3"><div class="inline-block px-2 py-0 rounded text-primary-500 bg-primary-500 bg-opacity-20 mr-2 mb-2">odqa</div><div class="inline-block px-2 py-0 rounded text-primary-500 bg-primary-500 bg-opacity-20 mr-2 mb-2">qa chatbot</div></div><h1 class="text-xl md:text-4xl font-bold tracking-tighter leading-tight md:leading-none mb-6 md:text-left">Advancing Open Domain Question Answering with RocketQA</h1><div class="flex items-center justify-between text-gray-600 mb-12"><div class="flex items-center"><img src="/assets/images/team/avatar-default.svg" class="w-8 h-auto rounded-full border border-gray-500 mr-4" alt="Nan Wang, Shubham Saboo"/><div class="text-gray-600">Nan Wang, Shubham Saboo</div></div><time dateTime="2022-01-04">4 January, 2022</time></div><div class="mx-auto markdown"><h2 id="overview">Overview</h2>
<p>We discussed building an Open Domain Question Answering (ODQA) system with Jina in our <a href="https://jina.ai/blog/2021-11-29-odqa-part-1/">previous post</a>. The two-stage pipeline consisting of a retriever and reader is widely used in practice.</p>
<p>As the reader part is relatively developed, most of the recent research focuses on the retriever part, which is in the process of development. <a href="https://arxiv.org/pdf/2010.08191.pdf">RocketQA</a> is one of the successful attempts in this direction. Until July 2021, it was the top algorithm on the <a href="https://microsoft.github.io/MSMARCO-Passage-Ranking-Submissions/leaderboard/">MS MARCO leaderboard</a>. Recently, RocketQA released its code and models. We are proud to partner with RocketQA, which will allow you to use the RocketQA pre-trained models directly from Jina Hub.</p>
<p>In this post, We'll introduce the idea of RocketQA and show you how to use it to build an ODQA using Jina.</p>
<p class="image-only"><span class="image-wrapper"><img src="/assets/images/blog/2022-01-03_RocketQA/figure1.svg" alt=""></span></p>
<h2 id="where-does-dpr-fail">Where does DPR Fail?</h2>
<p>As one of the dense-vector methods, DPR (Dense Passage Retrieval) is the first attempt to show that dense vector retrieval can outperform the term-based methods with a simple training procedure.</p>
<p>Negative sampling is one of the most important methods used in DPR. The DPR proposed using gold passages (correct question-answer pairs) from a mini-batch as a positive sample and <code>BM-25</code> to generate the negative samples. To be more specific, given a positive sample, DPR uses <code>BM-25</code> to retrieve the most matched passages as negative samples that do not contain the right answers. By feeding both the positive and negative samples to the training procedure, the dual encoder model learns to create a vector space. In this vector space, relevant questions and answers will have smaller distances than the irrelevant pairs.</p>
<p class="image-only"><span class="image-wrapper"><img src="/assets/images/blog/2022-01-03_RocketQA/figure2.svg" alt=""></span></p>
<p>This method works well in general. But after a close look, we will notice that some of the negative samples are false negatives because of the noisy training data. For example, <strong>"DNA is made up of molecules called nucleotides"</strong> is a correct answer, but it is considered a negative sample.</p>
<p>Another issue with negative sampling in DPR is that the negative samples are generated from the same batch as the positive samples. This setting is very different from the actual use cases. In practice, both the matched and the mismatched passages are retrieved from the whole corpus instead of a set of selected passages. This mismatch leads to the situation where the model was trained with some simple negative samples but was asked to distinguish hard negative samples during inference.</p>
<h2 id="how-does-rocketqa-work">How does RocketQA work?</h2>
<p>RocketQA introduced a cross-attention encoder to rerank the retrieved results and a four-step pipeline to improve the training procedure. Let's understand both of them in detail:</p>
<p class="image-only"><span class="image-wrapper"><img src="/assets/images/blog/2022-01-03_RocketQA/figure3.svg" alt=""></span></p>
<h3 id="cross-encoder">Cross Encoder</h3>
<p>Besides the dual encoders for independently encoding the questions and passages, RocketQA uses another transformer-based model to learn the cross-correlation between the questions and the passages. This model is called a cross encoder, which is more precise due to the cross attention to the question and the passages. However, it requires more computations and can only be applied to a limited number of candidates.</p>
<p class="image-only"><span class="image-wrapper"><img src="/assets/images/blog/2022-01-03_RocketQA/figure4.svg" alt=""></span></p>
<p class="image-only"><span class="image-wrapper"><img src="/assets/images/blog/2022-01-03_RocketQA/figure5.svg" alt=""></span></p>
<h3 id="four-step-training-procedure">Four-step Training Procedure</h3>
<p>RocketQA uses a four-step procedure to train the dual encoder and the cross encoder using an end-to-end pipeline.</p>
<ol>
<li>RocketQA uses cross-batch sampling to generate hard negative samples. This solves the issue of in-batch sampling of DPR so that the model gets aware of the negative samples, which are hard to distinguish.</li>
<li>In this step, RocketQA trains the cross encoder. Instead of using <code>BM25</code> for generating negative samples as in step 1. RocketQA uses the dual encoder trained from step 1 to filter out the false positive ones from the hard negative samples. Another benefit of this is to finetune the cross encoder with the data distribution learned from the dual encoder.</li>
<li>In this step, RocketQA retrains the dual encoder. To filter out the false-positive samples, RocketQA uses both the dual encoder from step 1 and the cross encoder from step 2 to further remove the data noises.</li>
<li>In this step, together with the cross encoder from step 2, and the dual encoder from step 3 it further filters the noise in the data. As both the cross encoder and the dual encoder have been trained, RocketQA lets you use them for generating the training data from the unlabeled dataset. This augmented data is combined with the labelled data to finetune the dual encoder.</li>
</ol>
<p>After training, the dual encoder and cross encoder is used to retrieve the passages. The cross encoder will return a confidence score for each pair of questions and answers.</p>
<p class="image-only"><span class="image-wrapper"><img src="/assets/images/blog/2022-01-03_RocketQA/figure6.svg" alt=""></span></p>
<h2 id="comparison-between-conventional-dpr-and-rocketqa">Comparison between Conventional DPR and RocketQA</h2>
<p>Using an example, the following table will illustrate the advantages of RocketQA over the conventional DPR model:</p>

























<table><thead><tr><th><strong>Question</strong></th><th><strong>DPR</strong></th><th><strong>RocketQA</strong></th></tr></thead><tbody><tr><td>What is DNA made of?</td><td>DNA is what makes us; from the colour of our eyes to the colour of our skin. Without DNA, it would be impossible for us to exist.</td><td><mark> DNA is made of the nitrogen basses cytosine, guanine, adenine, and thymine, phosphates, the sugar deoxyribose, and is all held together by hydrogen bonds. </mark></td></tr><tr><td></td><td>DNA contains the instructions for making you. How you look, what blood type you have, even your tendency to get some diseases. It is found inside the nucleus in just about every single cell of your body. In this lab, you'll break away the membrane around the cell and its nucleus so that you can see your very own DNA. Materials.</td><td><mark> DNA is made up of molecules called nucleotides. Each nucleotide contains a phosphate group, a sugar group and a nitrogen base. </mark> The four types of nitrogen bases are adenine (A), thymine (T), guanine (G) and cytosine (C)</td></tr><tr><td></td><td>DNA is a double helix formed by base pairs attached to a sugar-phosphate backbone. DNA, or deoxyribonucleic acid, is the hereditary material in humans and almost all other organisms. Nearly every cell in a persons body has the same DNA. Most DNA is located in the cell nucleus (where it is called nuclear DNA), but a small amount of DNA can also be found in the mitochondria (where it is called mitochondrial DNA or mtDNA). <mark> The information in DNA is stored as a code made up of four chemical bases: adenine (A), guanine (G), cytosine (C), and thymine (T).</mark> The structure of the double helix is somewhat like a ladder, with the base pairs forming the ladder rungs and the sugar and phosphate molecules forming the vertical sidepieces of the ladder. An important property of DNA is that it can replicate, or make copies of itself.</td><td>DNA is made up of molecules called nucleotides. Each nucleotide contains a phosphate group, a sugar group and a nitrogen base. The four types of nitrogen bases are adenine (A), thymine (T), guanine (G) and cytosine (C). The order of these bases is what determines DNA's instructions, or genetic code.</td></tr></tbody></table>
<h2 id="using-rocketqa-with-jina">Using RocketQA with Jina</h2>
<p>RocketQA is available at <a href="https://hub.jina.ai/">Jina Hub</a>, and it integrates seamlessly with Jina. We create a <code>Flow</code> for indexing the <code>Document</code> in the code below. The Document passages are stored in the <code>.tags['para']</code> field. You can pass the <code>.tags['title']</code> to improve accuracy. In the index Flow, we use <code>RocketQADualEncoder</code> to encode the passages into vectors and store them with <code>SimpleIndexer</code>.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> jina <span class="hljs-keyword">import</span> Document, Flow

<span class="hljs-comment"># Creating a Document object</span>
doc = Document(tags={<span class="hljs-string">'title'</span>: title, <span class="hljs-string">'para'</span>: para})

<span class="hljs-comment"># Creating the indexing flow with RockectQADualEncoder and SimpleIndexer</span>
flow = (Flow()
        .add(uses=<span class="hljs-string">'jinahub+docker://RocketQADualEncoder'</span>,
        uses_with={<span class="hljs-string">'use_cuda'</span>: <span class="hljs-literal">False</span>})
        .add(uses=<span class="hljs-string">'jinahub://SimpleIndexer'</span>,
        uses_metas={<span class="hljs-string">'workspace'</span>: <span class="hljs-string">'workspace_rocketqa'</span>}))

<span class="hljs-comment"># Indexing the Documents using the flow</span>
<span class="hljs-keyword">with</span> flow:
   flow.post(on=<span class="hljs-string">'/index'</span>, inputs=[doc,])
</code></pre>
<p>For querying, we will create a query flow as shown below. Besides the <code>RocketQADualEncoder</code>, we also use <code>RocketQAReranker</code> for reranking the results which implements the cross encoder part in RocketQA.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> jina <span class="hljs-keyword">import</span> Flow

<span class="hljs-comment"># Creating the Query flow </span>
flow = (Flow(use_cors=<span class="hljs-literal">True</span>, protocol=<span class="hljs-string">'http'</span>, port_expose=<span class="hljs-number">45678</span>)
    .add(uses=<span class="hljs-string">'jinahub+docker://RocketQADualEncoder'</span>,
        uses_with={<span class="hljs-string">'use_cuda'</span>: <span class="hljs-literal">False</span>})
    .add(uses=<span class="hljs-string">'jinahub://SimpleIndexer'</span>,
        uses_metas={<span class="hljs-string">'workspace'</span>: <span class="hljs-string">'workspace_rocketqa'</span>},
        uses_with={<span class="hljs-string">'match_args'</span>: {<span class="hljs-string">'limits'</span>: <span class="hljs-number">10</span>}})
    .add(uses=<span class="hljs-string">'jinahub+docker://RocketQAReranker'</span>,        
         uses_with={<span class="hljs-string">'model'</span>: <span class="hljs-string">'v1_marco_ce'</span>, <span class="hljs-string">'use_cuda'</span>: <span class="hljs-literal">False</span>}))
 
 <span class="hljs-comment"># Opening the query flow for incoming queries</span>
 <span class="hljs-keyword">with</span> flow:
     <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
         question = <span class="hljs-built_in">input</span>(<span class="hljs-string">'Question?: '</span>)
         <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> question:
             <span class="hljs-keyword">break</span>
        f.post(on=<span class="hljs-string">'/search'</span>, inputs=Document(text=question),
        on_done=print_answers)
</code></pre>
<p>You can find the complete source code <a href="https://github.com/jina-ai/example-odqa">here</a>.</p>
<h2 id="summary">Summary</h2>
<p>In this post, we have given a short introduction to RocketQA and shown you how to use it with Jina. The ODQA field is an active topic attracting more and more researchers. At Jina AI, we are committed to reducing the friction between academic research and their real-world applications by making state-of-the-art frameworks accessible to all.</p>
<p>Stay tuned for more updates and Happy searching!</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://hub.jina.ai/executor/27h1qsmc">RocketQADualEncoder</a></li>
<li><a href="https://hub.jina.ai/executor/ao0cuqe8">RocketQAReranker</a></li>
<li><a href="../blog/2021-11-29-odqa-part-1/">Building Open Domain QA System with Jina</a></li>
</ul></div></article></div></main></div></div><div class="jsx-1956813867"><div class="bg-primary-500 text-white"><div class="jsx-1956813867 flex flex-row justify-center md:justify-between px-6 md:px-0"><div class="jsx-1956813867 footer-left-margin hidden md:block"></div><div class="jsx-1956813867 flex justify-center flex-col md:flex-row"><div class="jsx-1956813867 pr-4 md:ml-0 md:py-16 md:mr-2 lg:mr-16 mt-16 md:mt-0"><div class="text-center md:text-left"><div class="flex md:justify-start"><div class="text-gray-900 flex items-center font-semibold text-3xl"><img src="/assets/images/logo-white.svg" alt="Jina.ai logo" class="w-24"/></div></div></div></div><div class="jsx-1956813867 grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-16 py-16"><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Company</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="/careers/">Join us</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/blog/">Blog</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://learn.jina.ai">Learn</a></li></ul></nav></div><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Products</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://github.com/jina-ai/jina">Jina</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://hub.jina.ai">Hub</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://github.com/jina-ai/finetuner">Finetuner</a></li></ul></nav></div><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Legal</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="/legal/#terms-of-service">Terms of Service</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/legal/#privacy-policy">Privacy Policy</a></li></ul></nav></div><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Social</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://github.com/jina-ai/">GitHub</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://www.linkedin.com/company/jinaai/">LinkedIn</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://twitter.com/jinaAI_/">Twitter</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://www.youtube.com/c/JinaAI/">YouTube</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://slack.jina.ai/">Slack</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://meetup.com/jina-community-meetup/">Meetup</a></li></ul></nav></div></div></div><div class="jsx-1956813867 footer-right-margin hidden md:block"></div></div><div class="text-center text-gray-100 text-sm py-2"><span class="block md:inline-block">© Jina AI 2020-2022. All rights reserved.</span></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Advancing Open Domain Question Answering with RocketQA","date":"2022-01-04","slug":"2022-01-03_RocketQA","author":"Nan Wang, Shubham Saboo","content":"\u003ch2 id=\"overview\"\u003eOverview\u003c/h2\u003e\n\u003cp\u003eWe discussed building an Open Domain Question Answering (ODQA) system with Jina in our \u003ca href=\"https://jina.ai/blog/2021-11-29-odqa-part-1/\"\u003eprevious post\u003c/a\u003e. The two-stage pipeline consisting of a retriever and reader is widely used in practice.\u003c/p\u003e\n\u003cp\u003eAs the reader part is relatively developed, most of the recent research focuses on the retriever part, which is in the process of development. \u003ca href=\"https://arxiv.org/pdf/2010.08191.pdf\"\u003eRocketQA\u003c/a\u003e is one of the successful attempts in this direction. Until July 2021, it was the top algorithm on the \u003ca href=\"https://microsoft.github.io/MSMARCO-Passage-Ranking-Submissions/leaderboard/\"\u003eMS MARCO leaderboard\u003c/a\u003e. Recently, RocketQA released its code and models. We are proud to partner with RocketQA, which will allow you to use the RocketQA pre-trained models directly from Jina Hub.\u003c/p\u003e\n\u003cp\u003eIn this post, We'll introduce the idea of RocketQA and show you how to use it to build an ODQA using Jina.\u003c/p\u003e\n\u003cp class=\"image-only\"\u003e\u003cspan class=\"image-wrapper\"\u003e\u003cimg src=\"/assets/images/blog/2022-01-03_RocketQA/figure1.svg\" alt=\"\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003ch2 id=\"where-does-dpr-fail\"\u003eWhere does DPR Fail?\u003c/h2\u003e\n\u003cp\u003eAs one of the dense-vector methods, DPR (Dense Passage Retrieval) is the first attempt to show that dense vector retrieval can outperform the term-based methods with a simple training procedure.\u003c/p\u003e\n\u003cp\u003eNegative sampling is one of the most important methods used in DPR. The DPR proposed using gold passages (correct question-answer pairs) from a mini-batch as a positive sample and \u003ccode\u003eBM-25\u003c/code\u003e to generate the negative samples. To be more specific, given a positive sample, DPR uses \u003ccode\u003eBM-25\u003c/code\u003e to retrieve the most matched passages as negative samples that do not contain the right answers. By feeding both the positive and negative samples to the training procedure, the dual encoder model learns to create a vector space. In this vector space, relevant questions and answers will have smaller distances than the irrelevant pairs.\u003c/p\u003e\n\u003cp class=\"image-only\"\u003e\u003cspan class=\"image-wrapper\"\u003e\u003cimg src=\"/assets/images/blog/2022-01-03_RocketQA/figure2.svg\" alt=\"\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cp\u003eThis method works well in general. But after a close look, we will notice that some of the negative samples are false negatives because of the noisy training data. For example, \u003cstrong\u003e\"DNA is made up of molecules called nucleotides\"\u003c/strong\u003e is a correct answer, but it is considered a negative sample.\u003c/p\u003e\n\u003cp\u003eAnother issue with negative sampling in DPR is that the negative samples are generated from the same batch as the positive samples. This setting is very different from the actual use cases. In practice, both the matched and the mismatched passages are retrieved from the whole corpus instead of a set of selected passages. This mismatch leads to the situation where the model was trained with some simple negative samples but was asked to distinguish hard negative samples during inference.\u003c/p\u003e\n\u003ch2 id=\"how-does-rocketqa-work\"\u003eHow does RocketQA work?\u003c/h2\u003e\n\u003cp\u003eRocketQA introduced a cross-attention encoder to rerank the retrieved results and a four-step pipeline to improve the training procedure. Let's understand both of them in detail:\u003c/p\u003e\n\u003cp class=\"image-only\"\u003e\u003cspan class=\"image-wrapper\"\u003e\u003cimg src=\"/assets/images/blog/2022-01-03_RocketQA/figure3.svg\" alt=\"\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003ch3 id=\"cross-encoder\"\u003eCross Encoder\u003c/h3\u003e\n\u003cp\u003eBesides the dual encoders for independently encoding the questions and passages, RocketQA uses another transformer-based model to learn the cross-correlation between the questions and the passages. This model is called a cross encoder, which is more precise due to the cross attention to the question and the passages. However, it requires more computations and can only be applied to a limited number of candidates.\u003c/p\u003e\n\u003cp class=\"image-only\"\u003e\u003cspan class=\"image-wrapper\"\u003e\u003cimg src=\"/assets/images/blog/2022-01-03_RocketQA/figure4.svg\" alt=\"\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cp class=\"image-only\"\u003e\u003cspan class=\"image-wrapper\"\u003e\u003cimg src=\"/assets/images/blog/2022-01-03_RocketQA/figure5.svg\" alt=\"\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003ch3 id=\"four-step-training-procedure\"\u003eFour-step Training Procedure\u003c/h3\u003e\n\u003cp\u003eRocketQA uses a four-step procedure to train the dual encoder and the cross encoder using an end-to-end pipeline.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eRocketQA uses cross-batch sampling to generate hard negative samples. This solves the issue of in-batch sampling of DPR so that the model gets aware of the negative samples, which are hard to distinguish.\u003c/li\u003e\n\u003cli\u003eIn this step, RocketQA trains the cross encoder. Instead of using \u003ccode\u003eBM25\u003c/code\u003e for generating negative samples as in step 1. RocketQA uses the dual encoder trained from step 1 to filter out the false positive ones from the hard negative samples. Another benefit of this is to finetune the cross encoder with the data distribution learned from the dual encoder.\u003c/li\u003e\n\u003cli\u003eIn this step, RocketQA retrains the dual encoder. To filter out the false-positive samples, RocketQA uses both the dual encoder from step 1 and the cross encoder from step 2 to further remove the data noises.\u003c/li\u003e\n\u003cli\u003eIn this step, together with the cross encoder from step 2, and the dual encoder from step 3 it further filters the noise in the data. As both the cross encoder and the dual encoder have been trained, RocketQA lets you use them for generating the training data from the unlabeled dataset. This augmented data is combined with the labelled data to finetune the dual encoder.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAfter training, the dual encoder and cross encoder is used to retrieve the passages. The cross encoder will return a confidence score for each pair of questions and answers.\u003c/p\u003e\n\u003cp class=\"image-only\"\u003e\u003cspan class=\"image-wrapper\"\u003e\u003cimg src=\"/assets/images/blog/2022-01-03_RocketQA/figure6.svg\" alt=\"\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003ch2 id=\"comparison-between-conventional-dpr-and-rocketqa\"\u003eComparison between Conventional DPR and RocketQA\u003c/h2\u003e\n\u003cp\u003eUsing an example, the following table will illustrate the advantages of RocketQA over the conventional DPR model:\u003c/p\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003e\u003cstrong\u003eQuestion\u003c/strong\u003e\u003c/th\u003e\u003cth\u003e\u003cstrong\u003eDPR\u003c/strong\u003e\u003c/th\u003e\u003cth\u003e\u003cstrong\u003eRocketQA\u003c/strong\u003e\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eWhat is DNA made of?\u003c/td\u003e\u003ctd\u003eDNA is what makes us; from the colour of our eyes to the colour of our skin. Without DNA, it would be impossible for us to exist.\u003c/td\u003e\u003ctd\u003e\u003cmark\u003e DNA is made of the nitrogen basses cytosine, guanine, adenine, and thymine, phosphates, the sugar deoxyribose, and is all held together by hydrogen bonds. \u003c/mark\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003eDNA contains the instructions for making you. How you look, what blood type you have, even your tendency to get some diseases. It is found inside the nucleus in just about every single cell of your body. In this lab, you'll break away the membrane around the cell and its nucleus so that you can see your very own DNA. Materials.\u003c/td\u003e\u003ctd\u003e\u003cmark\u003e DNA is made up of molecules called nucleotides. Each nucleotide contains a phosphate group, a sugar group and a nitrogen base. \u003c/mark\u003e The four types of nitrogen bases are adenine (A), thymine (T), guanine (G) and cytosine (C)\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003c/td\u003e\u003ctd\u003eDNA is a double helix formed by base pairs attached to a sugar-phosphate backbone. DNA, or deoxyribonucleic acid, is the hereditary material in humans and almost all other organisms. Nearly every cell in a persons body has the same DNA. Most DNA is located in the cell nucleus (where it is called nuclear DNA), but a small amount of DNA can also be found in the mitochondria (where it is called mitochondrial DNA or mtDNA). \u003cmark\u003e The information in DNA is stored as a code made up of four chemical bases: adenine (A), guanine (G), cytosine (C), and thymine (T).\u003c/mark\u003e The structure of the double helix is somewhat like a ladder, with the base pairs forming the ladder rungs and the sugar and phosphate molecules forming the vertical sidepieces of the ladder. An important property of DNA is that it can replicate, or make copies of itself.\u003c/td\u003e\u003ctd\u003eDNA is made up of molecules called nucleotides. Each nucleotide contains a phosphate group, a sugar group and a nitrogen base. The four types of nitrogen bases are adenine (A), thymine (T), guanine (G) and cytosine (C). The order of these bases is what determines DNA's instructions, or genetic code.\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\n\u003ch2 id=\"using-rocketqa-with-jina\"\u003eUsing RocketQA with Jina\u003c/h2\u003e\n\u003cp\u003eRocketQA is available at \u003ca href=\"https://hub.jina.ai/\"\u003eJina Hub\u003c/a\u003e, and it integrates seamlessly with Jina. We create a \u003ccode\u003eFlow\u003c/code\u003e for indexing the \u003ccode\u003eDocument\u003c/code\u003e in the code below. The Document passages are stored in the \u003ccode\u003e.tags['para']\u003c/code\u003e field. You can pass the \u003ccode\u003e.tags['title']\u003c/code\u003e to improve accuracy. In the index Flow, we use \u003ccode\u003eRocketQADualEncoder\u003c/code\u003e to encode the passages into vectors and store them with \u003ccode\u003eSimpleIndexer\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e jina \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e Document, Flow\n\n\u003cspan class=\"hljs-comment\"\u003e# Creating a Document object\u003c/span\u003e\ndoc = Document(tags={\u003cspan class=\"hljs-string\"\u003e'title'\u003c/span\u003e: title, \u003cspan class=\"hljs-string\"\u003e'para'\u003c/span\u003e: para})\n\n\u003cspan class=\"hljs-comment\"\u003e# Creating the indexing flow with RockectQADualEncoder and SimpleIndexer\u003c/span\u003e\nflow = (Flow()\n        .add(uses=\u003cspan class=\"hljs-string\"\u003e'jinahub+docker://RocketQADualEncoder'\u003c/span\u003e,\n        uses_with={\u003cspan class=\"hljs-string\"\u003e'use_cuda'\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e})\n        .add(uses=\u003cspan class=\"hljs-string\"\u003e'jinahub://SimpleIndexer'\u003c/span\u003e,\n        uses_metas={\u003cspan class=\"hljs-string\"\u003e'workspace'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'workspace_rocketqa'\u003c/span\u003e}))\n\n\u003cspan class=\"hljs-comment\"\u003e# Indexing the Documents using the flow\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e flow:\n   flow.post(on=\u003cspan class=\"hljs-string\"\u003e'/index'\u003c/span\u003e, inputs=[doc,])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor querying, we will create a query flow as shown below. Besides the \u003ccode\u003eRocketQADualEncoder\u003c/code\u003e, we also use \u003ccode\u003eRocketQAReranker\u003c/code\u003e for reranking the results which implements the cross encoder part in RocketQA.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e jina \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e Flow\n\n\u003cspan class=\"hljs-comment\"\u003e# Creating the Query flow \u003c/span\u003e\nflow = (Flow(use_cors=\u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e, protocol=\u003cspan class=\"hljs-string\"\u003e'http'\u003c/span\u003e, port_expose=\u003cspan class=\"hljs-number\"\u003e45678\u003c/span\u003e)\n    .add(uses=\u003cspan class=\"hljs-string\"\u003e'jinahub+docker://RocketQADualEncoder'\u003c/span\u003e,\n        uses_with={\u003cspan class=\"hljs-string\"\u003e'use_cuda'\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e})\n    .add(uses=\u003cspan class=\"hljs-string\"\u003e'jinahub://SimpleIndexer'\u003c/span\u003e,\n        uses_metas={\u003cspan class=\"hljs-string\"\u003e'workspace'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'workspace_rocketqa'\u003c/span\u003e},\n        uses_with={\u003cspan class=\"hljs-string\"\u003e'match_args'\u003c/span\u003e: {\u003cspan class=\"hljs-string\"\u003e'limits'\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e}})\n    .add(uses=\u003cspan class=\"hljs-string\"\u003e'jinahub+docker://RocketQAReranker'\u003c/span\u003e,        \n         uses_with={\u003cspan class=\"hljs-string\"\u003e'model'\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'v1_marco_ce'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'use_cuda'\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e}))\n \n \u003cspan class=\"hljs-comment\"\u003e# Opening the query flow for incoming queries\u003c/span\u003e\n \u003cspan class=\"hljs-keyword\"\u003ewith\u003c/span\u003e flow:\n     \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e:\n         question = \u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Question?: '\u003c/span\u003e)\n         \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enot\u003c/span\u003e question:\n             \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e\n        f.post(on=\u003cspan class=\"hljs-string\"\u003e'/search'\u003c/span\u003e, inputs=Document(text=question),\n        on_done=print_answers)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou can find the complete source code \u003ca href=\"https://github.com/jina-ai/example-odqa\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\u003cp\u003eIn this post, we have given a short introduction to RocketQA and shown you how to use it with Jina. The ODQA field is an active topic attracting more and more researchers. At Jina AI, we are committed to reducing the friction between academic research and their real-world applications by making state-of-the-art frameworks accessible to all.\u003c/p\u003e\n\u003cp\u003eStay tuned for more updates and Happy searching!\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hub.jina.ai/executor/27h1qsmc\"\u003eRocketQADualEncoder\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hub.jina.ai/executor/ao0cuqe8\"\u003eRocketQAReranker\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"../blog/2021-11-29-odqa-part-1/\"\u003eBuilding Open Domain QA System with Jina\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","coverImage":"/assets/images/blog/2022-01-03_RocketQA/cover.png","tags":["odqa","qa chatbot"],"sanitize":false,"gfm":true}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"2022-01-03_RocketQA"},"buildId":"QU34lMMGJ1oQ3CbyH400h","runtimeConfig":{},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
{"pageProps":{"post":{"title":"Sharing DocumentArray Across Machines","date":"2021-12-21","slug":"2021-12-21_DA_push_pull","author":"Shubham Saboo, Jyoti Bisht","content":"<h2 id=\"background\">Background</h2>\n<p>One day, an employee at Jina AI was working on a remote GPU, i.e. Google Colab. As they tried to make a <code>DocumentArray</code> and work with its manipulation, they got an error that wasn’t solvable by them and needed external assistance. Upon getting external help, they found that the error was due to the missing environment dependencies on the remote GPU. They then decided to move the development to their local system that was already configured to work with Jina.</p>\n<p>The above paragraph describes a very common and challenging situation faced by almost everybody when working in a remote environment. Firstly, it is difficult to determine what environment is running in the backend. Secondly, there may be different kinds of issues and bugs that need to be addressed, and giving others access to the entire file is not a super safe way to do it.</p>\n<h2 id=\"overview\">Overview</h2>\n<p>We all know about Jina’s <code>DocumentArray</code>. It is used to store Document objects. It is similar to Python’s list implementation, where you can construct, delete, insert, sort, and traverse a <code>DocumentArray</code> object. This blog will walk you through a very special feature of <code>DocumentArray</code>: <code>push</code> and <code>pull</code>.</p>\n<p><code>DocumentArray</code> is capable of importing data and exporting data. This is not limited to a single format but spans over various formats. For example, if you want to work with a JSON file, you might use <code>.to_json()</code> for exporting data into JSON. And if somebody needs to read that JSON file they can just use the <code>.load_json()</code> for importing the data.</p>\n<p>Similarly, Jina allows the import and export of data to and from any remote cloud storage. The method we use for exporting data to the cloud is simply known as <code>push()</code>, and the method used for importing data is known as <code>pull()</code>. This allows users to share the <code>DocumentArray</code> object across machines from anywhere in the world.</p>\n<h2 id=\"documentarray-pushpull-example\">DocumentArray Push/Pull Example</h2>\n<p>Let’s look at a simple example of <code>push</code> and <code>pull</code> in action. Jack wants to create a   <code>DocumentArray</code>, do some pre-processing from his side, and share it with his colleague Janice living in the other part of the world. So Jack creates a <code>DocumentArray</code> object <code>da</code>, applies the pre-processing logic, and pushes the <code>da</code> object with a unique key ID to store it on a remote cloud machine using the <code>push()</code> method. He uses the following code to do that:</p>\n<p class=\"image-only\"><span class=\"image-wrapper\"><img src=\"/assets/images/blog/2021-12-21_DA_push_pull/push.svg\" alt=\"\"></span></p>\n<p align=\"center\">\nFig 1. Push method for exporting DocumentArray\n</p>\n<p>Now, Janice wants to use the same <code>DocumentArray</code> object that her colleague Jack has created and to do that, she needs to know the unique key ID associated with the particular object. Once she has the key, she can use the <code>pull()</code> method to fetch the <code>DocumentArray</code> object into her local system from anywhere in the world. She uses the following code to do so:</p>\n<p class=\"image-only\"><span class=\"image-wrapper\"><img src=\"/assets/images/blog/2021-12-21_DA_push_pull/pull.svg\" alt=\"\"></span></p>\n<p align=\"center\">\nFig 2. Pull method for importing DocumentArray\n</p>\n<h2 id=\"documentarray-push-flow\">DocumentArray Push Flow</h2>\n<p>When a user pushes the data from his local system to the server, the following process takes place:</p>\n<ul>\n<li>The data along with the user token is sent to Jina API.</li>\n<li>The Jina API server verifies the following :\n<ul>\n<li>S3 address of the request</li>\n<li>The expiration of the request made</li>\n<li>The token and its validity</li>\n<li>The size of the data and time of the creation of the request</li>\n<li>Metadata such as Jina’s version etc.</li>\n</ul>\n</li>\n<li>Once verified, the response is sent in the form of a success message. Otherwise, a failure message is sent.</li>\n</ul>\n<!-- <script src=\"https://gist.github.com/nan-wang/e4a872ec40803eabbbcc6618a4eccb1d.js\"></script> -->\n<blockquote>\n<p><strong>Note</strong>: The <code>DocumentArray</code> storage is temporary and will be deleted automatically after seven days of creating the token. Also, using the same token will override the existing data.</p>\n</blockquote>\n<h2 id=\"documentarray-pull-flow\">DocumentArray Pull Flow</h2>\n<p>When a user tries to access a <code>DocumentArray</code> from the cloud and export it, the following process takes place:</p>\n<ul>\n<li>A request is made, and the token is sent to the Jina API</li>\n<li>The server verifies and stores the download time and the metadata. Upon successful verification, a response is sent back in the form of a URL. This URL can be used for downloading the data.</li>\n<li>Once a <code>get</code> request is made on that URL, the requested data is sent from the S3 server to the user.</li>\n</ul>\n<h2 id=\"summary\">Summary</h2>\n<p>What you saw above is the story of how collaboration looks with Jina’s search framework. It lets you work in a collaborative environment without worrying about how to share a piece of code or logic safely and securely. With <code>DocumentArray</code>’s new push and pull methods, you can efficiently work with data stored on the cloud by transferring it to the local system. Jina allows you to build efficient search engines and hosts the data types and structures that are built for speed, efficiency, and optimised engineering.</p>\n<h2 id=\"references\">References</h2>\n<ul>\n<li><a href=\"https://docs.jina.ai/fundamentals/document/documentarray-api/#sharing-documentarray-across-machines\">Documentation</a></li>\n<li><a href=\"https://github.com/jina-ai/jina\">GitHub Repository</a></li>\n</ul>","coverImage":"/assets/images/blog/2021-12-21_DA_push_pull/DA_PushPull.png","tags":["DocumentArray","feature","search"],"sanitize":false}},"__N_SSG":true}